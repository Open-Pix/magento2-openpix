<?php
/**
 * Copyright Â© Magento, Inc. All rights reserved.
 * See COPYING.txt for license details.
 */
?>
<?php
/** @var $block \OpenPix\Pix\Block\Checkout\Success */
?>
<?php
$order = $block->getOrder();
$payment = $order->getPayment();
$src = $block->getPluginSrc();
$correlationID = $order->getOpenpixCorrelationid();
echo $src;
$json = json_encode(
    [
        'order' => $order->getData(),
        'payment' => $payment->getData(),
        'src' => $src,
    ],
    JSON_PRETTY_PRINT
);

// echo "<pre> $json </pre>";
?>

<?php if ($payment->getMethod() === 'openpix_pix'): ?>
    <div id='openpix-order' style='margin-bottom: 40px'></div>

    <div class="actions openpix-pix" data-bind="scope: 'openpix-pix'">
     <!-- ko template: getTemplate() --><!-- /ko -->
    </div>



    <script type="text/x-magento-init">
     {
           "*": {
               "Magento_Ui/js/core/app": {
                   "components": {
                       "openpix-pix": {
                           "component": "OpenPix_Pix/js/view/checkout/order_success",
                           "template" : "OpenPix_Pix/checkout/order_success",
                           "src" : "https://plugin.openpix.com.br/v1/openpix.js",
                           "paymentCode" : "openpix_pix"
                       }
                   }
               }
           }
       }
    </script>

<?php endif; ?>
